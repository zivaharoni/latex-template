\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{doc_premable}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% PACKAGES %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[backend=biber,style=ieee]{biblatex}
\addbibresource{ref.bib}

\usepackage{hyperref}
\usepackage{amssymb,amsthm}
\usepackage[cmex10]{amsmath}
\usepackage{graphicx}
\usepackage{psfrag}
\usepackage{subfigure}
\usepackage{empheq}
\usepackage{mathtools}
\usepackage{standalone}
\usepackage{import}
\usepackage{color}
\usepackage{tcolorbox}
\usepackage{dsfont}
\usepackage{float}
\usepackage{stfloats}
\usepackage{lipsum}
\usepackage{pdfpages}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{csquotes}
\newcommand{\algrule}[1][.2pt]{\par\vskip.5\baselineskip\hrule height #1\par\vskip.5\baselineskip}
\usepackage{tcolorbox}
\usepackage[margin=2.425cm]{geometry}
% \usepackage{ntheorem}
% \usepackage[margin=0.5in]{geometry}
\usepackage{wrapfig}

\usepackage[acronym]{glossaries-extra}
\setabbreviationstyle[acronym]{long-short}
\glssetcategoryattribute{acronym}{nohyperfirst}{true}

\renewcommand*{\glsdonohyperlink}[2]{%
 {\glsxtrprotectlinks \glsdohypertarget{#1}{#2}}}
 \newcommand*\myglsentry[1]{
  \protect\ifglsused{#1}{
    \glsentryshort{#1}
  }{
    \glsentrylong{#1}
  }
}

\makeatletter
\def\blfootnote{\gdef\@thefnmark{}\@footnotetext}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% DEFINITIONS %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\parskip}{0.5em}
\newcommand{\todo}[1]{\textcolor{red}{#1}}
\DeclareMathOperator*{\argmax}{\arg\max}
\DeclareMathOperator*{\argmin}{\arg\min}
\DeclareMathOperator*{\nn}{\nonumber}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclareMathOperator*{\supp}{\text{supp}}
\allowdisplaybreaks
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}


\newtheorem{lemma}{Lemma}
\newtheorem*{problem*}{Problem statement}
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\theoremstyle{definition}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}
\newtheorem{experiment}{Experiment}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
% \newtheorem{problem}{Problem}
\newtheorem{idea}{Idea}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% ALIASES %%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%% Blackboard Bold %%%%% 
\newcommand{\bA}{\mathbb{A}}
\newcommand{\bB}{\mathbb{B}}
\newcommand{\bC}{\mathbb{C}}
\newcommand{\bD}{\mathbb{D}}
\newcommand{\bE}{\mathbb{E}}
\newcommand{\bF}{\mathbb{F}}
\newcommand{\bG}{\mathbb{G}}
\newcommand{\bH}{\mathbb{H}}
\newcommand{\bI}{\mathbb{I}}
\newcommand{\bJ}{\mathbb{J}}
\newcommand{\bK}{\mathbb{K}}
\newcommand{\bL}{\mathbb{L}}
\newcommand{\bM}{\mathbb{M}}
\newcommand{\bN}{\mathbb{N}}
\newcommand{\bO}{\mathbb{O}}
\newcommand{\bP}{\mathbb{P}}
\newcommand{\bQ}{\mathbb{Q}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\bS}{\mathbb{S}}
\newcommand{\bT}{\mathbb{T}}
\newcommand{\bU}{\mathbb{U}}
\newcommand{\bV}{\mathbb{V}}
\newcommand{\bW}{\mathbb{W}}
\newcommand{\bX}{\mathbb{X}}
\newcommand{\bY}{\mathbb{Y}}
\newcommand{\bZ}{\mathbb{Z}}

%%%%% Calligraphic %%%%% 
\newcommand{\cA}{\mathcal{A}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}}
\newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}}
\newcommand{\cZ}{\mathcal{Z}}


%%%%% sans serif %%%%%
\newcommand{\sA}{\mathsf{A}}
\newcommand{\sB}{\mathsf{B}}
\newcommand{\sC}{\mathsf{C}}
\newcommand{\sD}{\mathsf{D}}
\newcommand{\sE}{\mathsf{E}}
\newcommand{\sF}{\mathsf{F}}
\newcommand{\sG}{\mathsf{G}}
\newcommand{\sH}{\mathsf{H}}
\newcommand{\sI}{\mathsf{I}}
\newcommand{\sJ}{\mathsf{J}}
\newcommand{\sK}{\mathsf{K}}
\newcommand{\sL}{\mathsf{L}}
\newcommand{\sM}{\mathsf{M}}
\newcommand{\sN}{\mathsf{N}}
\newcommand{\sO}{\mathsf{O}}
\newcommand{\sP}{\mathsf{P}}
\newcommand{\sQ}{\mathsf{Q}}
\newcommand{\sR}{\mathsf{R}}
\newcommand{\sS}{\mathsf{S}}
\newcommand{\sT}{\mathsf{T}}
\newcommand{\sU}{\mathsf{U}}
\newcommand{\sV}{\mathsf{V}}
\newcommand{\sW}{\mathsf{W}}
\newcommand{\sX}{\mathsf{X}}
\newcommand{\sY}{\mathsf{Y}}
\newcommand{\sZ}{\mathsf{Z}}

%%%%% bold vector %%%%%
\newcommand{\vA}{\mathbf{A}}
\newcommand{\vB}{\mathbf{B}}
\newcommand{\vC}{\mathbf{C}}
\newcommand{\vD}{\mathbf{D}}
\newcommand{\vE}{\mathbf{E}}
\newcommand{\vF}{\mathbf{F}}
\newcommand{\vG}{\mathbf{G}}
\newcommand{\vH}{\mathbf{H}}
\newcommand{\vI}{\mathbf{I}}
\newcommand{\vJ}{\mathbf{J}}
\newcommand{\vK}{\mathbf{K}}
\newcommand{\vL}{\mathbf{L}}
\newcommand{\vM}{\mathbf{M}}
\newcommand{\vN}{\mathbf{N}}
\newcommand{\vO}{\mathbf{O}}
\newcommand{\vP}{\mathbf{P}}
\newcommand{\vQ}{\mathbf{Q}}
\newcommand{\vR}{\mathbf{R}}
\newcommand{\vS}{\mathbf{S}}
\newcommand{\vT}{\mathbf{T}}
\newcommand{\vU}{\mathbf{U}}
\newcommand{\vV}{\mathbf{V}}
\newcommand{\vW}{\mathbf{W}}
\newcommand{\vX}{\mathbf{X}}
\newcommand{\vY}{\mathbf{Y}}
\newcommand{\vZ}{\mathbf{Z}}
\newcommand{\vzero}[0]{\mathbf 0}
\newcommand{\vone}[0]{\mathbf 1}


\newcommand\independent{\protect\mathpalette{\protect\independenT}{\perp}}
\def\independenT#1#2{\mathrel{\rlap{$#1#2$}\mkern2mu{#1#2}}}



\newcommand{\cov}[1]{\mathsf{Cov}\left(#1\right)}
\newcommand{\var}[1]{\mathsf{Var}\left(#1\right)}
\newcommand{\sign}[1]{\mathrm{sign}\left(#1\right)}
\newcommand{\tr}[1]{\mathrm{tr}\left(#1\right)}

\newcommand{\Cross}{\mathbin{\tikz [x=1.6ex,y=1.6ex,line width=.15ex] \draw (0,0) -- (1,1) (0,1) -- (1,0);}}%


%%%%%%%%%%%%%% Functions and parenthesis %%%%%%%%%%%%%%
\newcommand{\bpar}[1]{\left(#1\right)}
\newcommand{\bbra}[1]{\left[#1\right]}
\newcommand{\bcurl}[1]{\left\{#1\right\}}
\newcommand{\bvert}[1]{\left\lvert#1\right\lvert}
\newcommand{\E}[1]{\mathbb{E}\left[#1\right]}
\newcommand{\Ep}[2]{\mathbb{E}_{#1}\left[#2\right]}
\newcommand{\Exp}[1]{\exp\left\{#1\right\}}
\newcommand{\f}[2]{#1\left(#2\right)}
\newcommand{\Ehat}[2]{\what{\mathbb{E}}\left[e^{T_{#2}}\right]}
\newcommand{\Eopt}[2]{\what{\mathbb{E}}\left[e^{\what{T}_{#2}}\right]}
\newcommand{\EHat}[2]{\what{\mathbb{E}}_{#1}^{#2}\left[e^{T}\right]}
\newcommand{\limSp}[3]{{#1}\stackrel{{#3}}{\longrightarrow} {#2}}

\newcommand{\wtilde}{\widetilde}
\newcommand{\what}{\widehat}




\newcommand{\vertiii}[1]{{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert #1 
    \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}


\newcommand*{\dd}{\, \mathsf{d}}
\makeatletter
\def\blfootnote{\gdef\@thefnmark{}\@footnotetext}
\makeatother
\makeatletter
\def\blfootnote{\gdef\@thefnmark{}\@footnotetext}
\makeatother
\newcommand{\widesim}[2][1.5]{
  \mathrel{\overset{#2}{\scalebox{#1}[1]{$\sim$}}}
}

\usepackage{setspace}


%%%%%% paper specific %%%%%%
\newcommand{\rnn}[1][]{\mathcal{G}_{\mathsf{RNN}}^{#1}}

\newcommand{\kl}[2]{\mathsf{D}_\mathsf{KL}\left(#1 \lVert #2\right)}
\newcommand{\klhat}[3]{\what{\mathsf{D}}_\mathsf{KL}^{(#3)}\left(#1 \lVert #2\right)}
\newcommand{\ckl}[3]{\mathsf{D}_\mathsf{KL}\left(#1 \lVert #2 \lvert #3\right)}
\newcommand{\tv}[2]{\mathsf{TV}\left(#1, #2\right)}
\newcommand{\ce}[2]{h_\mathsf{CE}\left(#1, #2\right)}


%%% constants %%%
\def\nref{{\mathsf{N}_\mathsf{aux}}}

\newacronym{cdf}{CDF}{cumulative distribution function}
\newacronym{ce}{CE}{cross entropy}
\newacronym{dv}{DV}{Donsker Vardhan}
\newacronym{elbo}{ELBO}{evidence lower bound}
\newacronym{eq}{eq.}{equation}
\newacronym{fig}{fig.}{figure}
\newacronym{hmm}{HMM}{hidden Markov model}
\newacronym{iid}{i.i.d.}{independently identically distributed}
\newacronym{kl}{KL}{Kullback Leibler}
\newacronym{lstm}{LSTM}{long short-term memory}
\newacronym{ml}{ML}{machine learning}
\newacronym{mlstm}{M-LSTM}{modified \myglsentry{lstm}}
\newacronym{nn}{NN}{neural network}
\newacronym{pdf}{PDF}{probability density function}
\newacronym{pmf}{PMF}{probability mass function}
\newacronym{rnn}{RNN}{recurrent neural network}
\newacronym{rv}{RV}{random variable}
\newacronym{sgd}{SGD}{stochastic gradient descent}
\newacronym{st}{s.t.}{such that}
\newacronym{thm}{thm.}{theorem}
\newacronym{tv}{TV}{total variation}
\newacronym{wp}{w.p.}{with probability}
\newacronym{wrt}{w.r.t.}{with respect to}
